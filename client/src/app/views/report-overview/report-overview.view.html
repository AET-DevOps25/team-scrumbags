<div class="flex gap-2 items-center">
  <button
    mat-icon-button
    aria-label="Back to report overview"
    [disabled]="!selectedReportId()"
    (click)="selectedReportId.set(undefined)"
  >
    <mat-icon>arrow_back</mat-icon>
  </button>
  <h2 class="text-xl font-semibold">Reports</h2>
</div>

<!-- The router outlet will switch between list and content -->
@if (selectedReportId()){
<app-report-content [reportId]="selectedReportId()!"></app-report-content>
} @else {
<app-report-list
  (selectedReportId)="selectedReportId.set($event)"
></app-report-list>
}

<!-- Always show the form here -->
<div class="mt-4">
  @if (!showForm()) {
  <button
    mat-mini-fab
    color="primary"
    aria-label="Add report"
    (click)="showForm.set(true)"
  >
    <mat-icon>add</mat-icon>
  </button>
  } @else {
  <form
    class="flex flex-row flex-wrap items-center gap-4 max-w-full"
    (ngSubmit)="onSubmit()"
  >
    <button
      mat-icon-button
      type="button"
      (click)="onCancel()"
      aria-label="Cancel"
      class="mb-2"
    >
      <mat-icon>close</mat-icon>
    </button>
    <mat-form-field appearance="outline" class="min-w-[180px]">
      <mat-label>Start Date</mat-label>
      <input
        matInput
        type="date"
        [(ngModel)]="periodStart"
        name="startDate"
        required
      />
    </mat-form-field>
    <mat-form-field appearance="outline" class="min-w-[180px]">
      <mat-label>End Date</mat-label>
      <input
        matInput
        type="date"
        [(ngModel)]="periodEnd"
        name="endDate"
        required
      />
    </mat-form-field>
    <mat-form-field appearance="outline" class="min-w-[200px]">
      <mat-label>Users</mat-label>
      <mat-select multiple [(ngModel)]="userIds" name="userIds">
        @for (user of possibleUsers(); track user.id) {
        <mat-option [value]="user.id">{{ user.username }}</mat-option>
        }
      </mat-select>
    </mat-form-field>
    <button
      mat-icon-button
      color="primary"
      type="submit"
      aria-label="Send"
      class="mb-2"
    >
      <mat-icon>send</mat-icon>
    </button>
  </form>
  }
</div>
